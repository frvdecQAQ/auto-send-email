# auto-send-email

### 使用前准备

​		1、`python` >= 3.7.1

​		2、在`main.py`同目录下创建`config`目录，目录里创建`my_email.txt`，`format.txt`，`replace.txt`

​		3、`my_email.txt`中一共三行，分别表示SMTP服务器地址，发送者邮箱，发送者邮箱密码

​		样例如下：

```python
smtp.163.com
ad*******@163.com
*********
```

​		4、`format.txt` 中第一行是邮件标题，第二行及以下是邮箱正文，需要替换的部分用$代替，样例如下：

```python
$活动邀请函
尊敬的$先生：
    您好！$活动特邀您$在$出席，如果您有时间和意愿前来参加，请在$回复到本邮箱。
    谢谢您的支持和配合!
-------
顺颂近祺
清华大学计算机系 **
2020年12月6日
```

​		5、`replace.txt`中每一行表示一封要发出的邮件，每一行第一个字符串表示收信者的邮箱，之后若干个字符串依次对应正文中要替换的$，字符串之间用英文逗号分隔，样例如下：

```
and17@mails.tsinghua.edu.cn,清华,安頔,清华,12月10日,清华大学,12月8日
10****424@qq.com,北大,安迪,北大,12月11日,北京大学,12月9日
```

​		6、注意所有的文本文件保存的编码格式应为utf-8，`replace.txt`中分隔符逗号是英文标点符号，尽量不要有多余的空格和回车



### 使用说明

​	先运行以下指令：

```python
python main.py generate
```

​	该指令会读取`replace.txt`和`format.txt`并在`config`目录下生成`recv_email.csv`，该表格每一行表示收信者地址，标题，正文，请核对无误后再执行以下指令：

```
python main.py send
```

​	该指令会读取`recv_email.csv`和`my_email.txt`的内容，按顺序间隔30s发送一封邮件，并在发送后输出有收信者地址，标题，正文以供查验。

​	如果在以上指令执行过程中有输出`ERROR`，可在代码中找到对应位置的错误信息输出进行查验。如果在发送过程中出现问题，会立即停止该邮件及之后邮件的发送，并且输出出现错误的发送事件相关信息。